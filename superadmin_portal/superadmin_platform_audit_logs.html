<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platform-Wide Audit Logs - Ark CMS</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body>
    <div class="app-layout">
        <aside class="sidebar">
            <img src="../assets/images/ark_logo.png" alt="Ark CMS Logo" class="logo">
            <nav class="sidebar-nav">
                 <span class="nav-section-title">Ark CMS SuperAdmin</span>
                <ul>
                    <li><a href="superadmin_dashboard.html"><span class="material-symbols-outlined">space_dashboard</span> Dashboard</a></li>
                </ul>
                <span class="nav-section-title">Tenant Management</span>
                <ul>
                    <li><a href="superadmin_data_fiduciaries.html"><span class="material-symbols-outlined">domain</span> Data Fiduciaries</a></li>
                </ul>
                <span class="nav-section-title">Platform Management</span>
                <ul>
                    <li><a href="superadmin_users.html"><span class="material-symbols-outlined">shield_person</span> SuperAdmin Users</a></li>
                    <li><a href="superadmin_global_settings.html"><span class="material-symbols-outlined">tune</span> Global Settings</a></li>
                    <li><a href="superadmin_notification_templates.html"><span class="material-symbols-outlined">text_format</span> Notification Templates</a></li>
                </ul>
                <span class="nav-section-title">Monitoring</span>
                <ul>
                    <li><a href="superadmin_platform_health.html"><span class="material-symbols-outlined">monitor_heart</span> Platform Health</a></li>
                    <li><a href="superadmin_platform_analytics.html"><span class="material-symbols-outlined">signal_cellular_alt</span> Platform Analytics</a></li>
                    <li><a href="superadmin_system_logs.html"><span class="material-symbols-outlined">plagiarism</span> System Logs</a></li>
                    <li><a href="superadmin_platform_audit_logs.html" class="active"><span class="material-symbols-outlined">admin_panel_settings</span> Platform Audit Logs</a></li>
                </ul>
                <!-- ... other SA nav items ... -->
                 <div class="sidebar-footer" style="margin-top: auto;">
                     <a href="superadmin_login.html" class="btn btn-secondary btn-full-width"><span class="material-symbols-outlined">logout</span> Logout</a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <header class="app-header">
                 <div class="hamburger-menu">
                    <span class="material-symbols-outlined">menu</span>
                </div>
                <h1 class="page-title">Platform-Wide Audit Logs</h1>
                 <div class="user-menu">
                    <div class="user-menu-trigger">
                        <div class="avatar">SA</div>
                        <span class="user-name-display ark-body-default">[SuperAdmin Name]</span>
                        <span class="material-symbols-outlined">arrow_drop_down</span>
                    </div>
                    <div class="user-menu-dropdown">
                        <a href="#">My Profile</a>
                        <a href="superadmin_login.html">Logout</a>
                    </div>
                </div>
            </header>
            
            <div class="alert alert-warning">
                <span class="material-symbols-outlined">warning</span>
                Access to platform-wide logs is audited. Use only for authorized purposes.
            </div>

            <div class="table-toolbar card mb-4">
                <form id="filterPlatformAuditLogsForm" class="d-flex flex-wrap align-center" style="gap: var(--space-md);">
                    <div class="form-group">
                        <label for="platAuditDateFrom" class="ark-label">Date From:</label>
                        <input type="datetime-local" id="platAuditDateFrom" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="platAuditDateTo" class="ark-label">Date To:</label>
                        <input type="datetime-local" id="platAuditDateTo" class="form-control">
                    </div>
                     <div class="form-group">
                        <label for="platAuditDfId" class="ark-label">Data Fiduciary (Tenant ID):</label>
                        <input type="text" id="platAuditDfId" class="form-control" placeholder="e.g., df_tenant_001">
                    </div>
                    <div class="form-group">
                        <label for="platAuditEventType" class="ark-label">Event Type:</label>
                        <input type="text" id="platAuditEventType" class="form-control" placeholder="e.g., DF_CREATED, USER_LOGIN_FAIL">
                    </div>
                    <div class="form-group">
                        <label for="platAuditActorType" class="ark-label">Actor Type:</label>
                        <select id="platAuditActorType" class="form-control">
                            <option value="">All</option>
                            <option value="SuperAdmin">SuperAdmin</option>
                            <option value="DFUser">DFUser</option>
                            <option value="DataPrincipal">DataPrincipal</option>
                            <option value="System">System</option>
                            <option value="APIClient">APIClient</option>
                        </select>
                    </div>
                     <div class="form-group">
                        <label for="platAuditActorId" class="ark-label">Actor Identifier:</label>
                        <input type="text" id="platAuditActorId" class="form-control" placeholder="User email or ID">
                    </div>
                     <div class="form-group">
                        <label for="platAuditTargetEntity" class="ark-label">Target Entity ID:</label>
                        <input type="text" id="platAuditTargetEntity" class="form-control" placeholder="ID of affected entity">
                    </div>
                    <button type="submit" class="btn btn-primary" style="align-self: flex-end; margin-bottom: var(--space-md);">Apply Filters</button>
                </form>
            </div>

            <div class="card table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>Data Fiduciary</th>
                            <th>Event Type</th>
                            <th>Actor</th>
                            <th>Action</th>
                            <th>Target Entity</th>
                            <th>Details (Summary)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>[YYYY-MM-DD HH:MM:SS]</td>
                            <td>N/A (Platform)</td>
                            <td>SUPERADMIN_LOGIN</td>
                            <td>[SuperAdmin Name] (SA)</td>
                            <td>SuperAdmin Login Success</td>
                            <td>N/A</td>
                            <td>IP: [10.0.0.1]</td>
                            <td><button class="btn btn-sm btn-subtle" data-modal-target="platformAuditLogDetailsModal" data-log-id="plog_001"><span class="material-symbols-outlined icon-only">visibility</span></button></td>
                        </tr>
                        <tr>
                            <td>[YYYY-MM-DD HH:MM:SS]</td>
                            <td>[DF Tenant Inc.] (df_tenant_001)</td>
                            <td>DF_USER_LOGIN</td>
                            <td>[DF Admin Example] (DFAdmin)</td>
                            <td>DF User Login Success</td>
                            <td>User: df_admin@example.com</td>
                            <td>IP: [192.168.1.100]</td>
                            <td><button class="btn btn-sm btn-subtle" data-modal-target="platformAuditLogDetailsModal" data-log-id="plog_002"><span class="material-symbols-outlined icon-only">visibility</span></button></td>
                        </tr>
                        <tr>
                            <td>[YYYY-MM-DD HH:MM:SS]</td>
                             <td>[Another DF Ltd.] (df_tenant_002)</td>
                            <td>CONSENT_GRANTED</td>
                            <td>[dp_another@example.com] (DP)</td>
                            <td>Consent Granted by DP</td>
                            <td>Artifact: [art_xyz123]</td>
                            <td>Purpose: [SVC_DELIVERY], Notice: [V1.0]</td>
                           <td><button class="btn btn-sm btn-subtle" data-modal-target="platformAuditLogDetailsModal" data-log-id="plog_003"><span class="material-symbols-outlined icon-only">visibility</span></button></td>
                        </tr>
                         <tr>
                            <td>[YYYY-MM-DD HH:MM:SS]</td>
                            <td>N/A (Platform)</td>
                            <td>DF_TENANT_CREATED</td>
                            <td>[SuperAdmin Name] (SA)</td>
                            <td>New DF Tenant Onboarded</td>
                            <td>DF: [New Tenant Corp]</td>
                            <td>Tenant ID: [df_tenant_003]</td>
                           <td><button class="btn btn-sm btn-subtle" data-modal-target="platformAuditLogDetailsModal" data-log-id="plog_004"><span class="material-symbols-outlined icon-only">visibility</span></button></td>
                        </tr>
                        <!-- More placeholder rows -->
                    </tbody>
                </table>
            </div>
             <div class="pagination">
                <button class="btn btn-subtle" disabled><span class="material-symbols-outlined icon-only">chevron_left</span></button>
                <span class="ark-body-default">Page 1 of X</span>
                <button class="btn btn-subtle"><span class="material-symbols-outlined icon-only">chevron_right</span></button>
            </div>
        </main>
    </div>

    <!-- Platform Audit Log Details Modal -->
    <div class="modal-overlay" id="platformAuditLogDetailsModal">
        <div class="modal-container" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title ark-h3">Platform Audit Log Details - <span id="platformAuditLogDetailId"></span></h3>
                <button class="modal-close-btn"><span class="material-symbols-outlined">close</span></button>
            </div>
            <div class="modal-body">
                <p><strong>Timestamp:</strong> <span id="platDetailTimestamp">[YYYY-MM-DD HH:MM:SS]</span></p>
                <p><strong>Data Fiduciary:</strong> <span id="platDetailDf">[DF Name (Tenant ID)]</span></p>
                <p><strong>Event Type:</strong> <span id="platDetailEventType">[Event Type]</span></p>
                <p><strong>Actor Type:</strong> <span id="platDetailActorType">[Actor Type]</span></p>
                <p><strong>Actor ID/Details:</strong> <span id="platDetailActor">[Actor Name/ID]</span></p>
                <p><strong>Action:</strong> <span id="platDetailAction">[Action Performed]</span></p>
                <p><strong>Target Entity Type:</strong> <span id="platDetailTargetType">[Type]</span></p>
                <p><strong>Target Entity ID:</strong> <span id="platDetailTargetId">[ID]</span></p>
                <p><strong>IP Address:</strong> <span id="platDetailIpAddress">[IP Address]</span></p>
                <p><strong>Full Details (JSON):</strong></p>
                <pre id="platDetailFullJson" style="background-color: var(--ark-gray-100); padding: var(--space-sm); border-radius: var(--border-radius-sm); max-height: 200px; overflow-y: auto;">{"key": "value", "old_value": "X", "new_value": "Y", "user_agent": "Mozilla/5.0..."}</pre>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-close-btn">Close</button>
            </div>
        </div>
    </div>

    <script src="../assets/js/main.js"></script>
    <script>
        populateUserSpecificElements("Super Admin");
        document.getElementById('filterPlatformAuditLogsForm')?.addEventListener('submit', function(e){
            e.preventDefault();
            alert('Platform Audit Logs filtered (Mock). Table would refresh.');
        });

        document.querySelectorAll('button[data-modal-target="platformAuditLogDetailsModal"]').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const logId = e.currentTarget.dataset.logId;
                document.getElementById('platformAuditLogDetailId').textContent = logId;
                // Mock populating other fields
                const rowCells = e.currentTarget.closest('tr').cells;
                document.getElementById('platDetailTimestamp').textContent = rowCells[0].textContent;
                document.getElementById('platDetailDf').textContent = rowCells[1].textContent;
                document.getElementById('platDetailEventType').textContent = rowCells[2].textContent;
                // Actor details parsing might be more complex in real scenario
                document.getElementById('platDetailActor').textContent = rowCells[3].textContent; 
                document.getElementById('platDetailAction').textContent = rowCells[4].textContent;
                document.getElementById('platDetailTargetId').textContent = rowCells[5].textContent; // Assuming Target Entity (ID)
                // For simplicity, not parsing Target Type separately for this mock
                document.getElementById('platDetailFullJson').textContent = JSON.stringify({
                    log_id: logId,
                    timestamp: rowCells[0].textContent,
                    df_context: rowCells[1].textContent,
                    event_type: rowCells[2].textContent,
                    actor: rowCells[3].textContent,
                    action_description: rowCells[4].textContent,
                    target_entity: rowCells[5].textContent,
                    raw_details: rowCells[6].textContent,
                    // ... other mock data
                }, null, 2);
            });
        });
    </script>
</body>
</html>